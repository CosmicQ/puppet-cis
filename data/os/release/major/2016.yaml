---
# SCM Mods - Per Microsoft
cis::windows::scm::scm_registry:
  EnhancedAntiSpoofing:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Biometrics\FacialFeatures'
    valuename: 'EnhancedAntiSpoofing'
    valuetype: 'Dword'
    valuedata: '1'
  EnableVirtualizationBasedSecurity:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\DeviceGuard'
    valuename: 'EnableVirtualizationBasedSecurity'
    valuetype: 'Dword'
    valuedata: '1'
  HypervisorEnforcedCodeIntegrity:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\DeviceGuard'
    valuename: 'HypervisorEnforcedCodeIntegrity'
    valuetype: 'Dword'
    valuedata: '1'
  LsaCfgFlags:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\DeviceGuard'
    valuename: 'LsaCfgFlags'
    valuetype: 'Dword'
    valuedata: '1'
  RequirePlatformSecurityFeatures:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\DeviceGuard'
    valuename: 'RequirePlatformSecurityFeatures'
    valuetype: 'Dword'
    valuedata: '3'
  MaxSize:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\EventLog\Application'
    valuename: 'MaxSize'
    valuetype: 'Dword'
    valuedata: '32768'
  MaxSize1:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\EventLog\Security'
    valuename: 'MaxSize'
    valuetype: 'Dword'
    valuedata: '196608'
  MaxSize2:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\EventLog\System'
    valuename: 'MaxSize'
    valuetype: 'Dword'
    valuedata: '32768'
  NoDataExecutionPrevention:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Explorer'
    valuename: 'NoDataExecutionPrevention'
    valuetype: 'Dword'
    valuedata: '0'
  NoHeapTerminationOnCorruption:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Explorer'
    valuename: 'NoHeapTerminationOnCorruption'
    valuetype: 'Dword'
    valuedata: '0'
  NoAutoplayfornonVolume:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Explorer'
    valuename: 'NoAutoplayfornonVolume'
    valuetype: 'Dword'
    valuedata: '1'
  NoGPOListChanges:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FB'
    valuename: 'NoGPOListChanges'
    valuetype: 'Dword'
    valuedata: '0'
  NoBackgroundPolicy:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FB'
    valuename: 'NoBackgroundPolicy'
    valuetype: 'Dword'
    valuedata: '0'
  EnableUserControl:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Installer'
    valuename: 'EnableUserControl'
    valuetype: 'Dword'
    valuedata: '0'
  AlwaysInstallElevated:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Installer'
    valuename: 'AlwaysInstallElevated'
    valuetype: 'Dword'
    valuedata: '0'
  AllowInsecureGuestAuth:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\LanmanWorkstation'
    valuename: 'AllowInsecureGuestAuth'
    valuetype: 'Dword'
    valuedata: '0'
  \\*\NETLOGON:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths'
    valuename: '\\*\NETLOGON'
    valuetype: 'String'
    valuedata: 'RequireMutualAuthenticatio:1, RequireIntegrit:1'
  \\*\SYSVOL:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\NetworkProvider\HardenedPaths'
    valuename: '\\*\SYSVOL'
    valuetype: 'String'
    valuedata: 'RequireMutualAuthenticatio:1, RequireIntegrit:1'
  NoLockScreenSlideshow:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Personalization'
    valuename: 'NoLockScreenSlideshow'
    valuetype: 'Dword'
    valuedata: '1'
  NoLockScreenCamera:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Personalization'
    valuename: 'NoLockScreenCamera'
    valuetype: 'Dword'
    valuedata: '1'
  EnableScriptBlockInvocationLogging:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging'
    valuename: 'EnableScriptBlockInvocationLogging'
    valuetype: 'Dword'
    valuedata: '0'
  EnableScriptBlockLogging:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging'
    valuename: 'EnableScriptBlockLogging'
    valuetype: 'Dword'
    valuedata: '1'
  DontDisplayNetworkSelectionUI:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\System'
    valuename: 'DontDisplayNetworkSelectionUI'
    valuetype: 'Dword'
    valuedata: '1'
  EnableSmartScreen:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\System'
    valuename: 'EnableSmartScreen'
    valuetype: 'Dword'
    valuedata: '1'
  EnumerateLocalUsers:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\System'
    valuename: 'EnumerateLocalUsers'
    valuetype: 'Dword'
    valuedata: '0'
  AllowIndexingEncryptedStoresOrItems:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Windows Search'
    valuename: 'AllowIndexingEncryptedStoresOrItems'
    valuetype: 'Dword'
    valuedata: '0'
  AllowUnencryptedTraffic:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\WinRM\Client'
    valuename: 'AllowUnencryptedTraffic'
    valuetype: 'Dword'
    valuedata: '0'
  AllowBasic:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\WinRM\Client'
    valuename: 'AllowBasic'
    valuetype: 'Dword'
    valuedata: '0'
  AllowDigest:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\WinRM\Client'
    valuename: 'AllowDigest'
    valuetype: 'Dword'
    valuedata: '0'
  AllowBasic1:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\WinRM\Service'
    valuename: 'AllowBasic'
    valuetype: 'Dword'
    valuedata: '0'
  DisableRunAs:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\WinRM\Service'
    valuename: 'DisableRunAs'
    valuetype: 'Dword'
    valuedata: '1'
  AllowUnencryptedTraffic1:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\WinRM\Service'
    valuename: 'AllowUnencryptedTraffic'
    valuetype: 'Dword'
    valuedata: '0'
  DisableBehaviorMonitoring:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Real-Time Protection'
    valuename: 'DisableBehaviorMonitoring'
    valuetype: 'Dword'
    valuedata: '0'
  DisableRemovableDriveScanning:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Scan'
    valuename: 'DisableRemovableDriveScanning'
    valuetype: 'Dword'
    valuedata: '0'
  DisableEmailScanning:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Scan'
    valuename: 'DisableEmailScanning'
    valuetype: 'Dword'
    valuedata: '0'
  SubmitSamplesConsent:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Spynet'
    valuename: 'SubmitSamplesConsent'
    valuetype: 'Dword'
    valuedata: '1'
  LocalSettingOverrideSpynetReporting:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Spynet'
    valuename: 'LocalSettingOverrideSpynetReporting'
    valuetype: 'Dword'
    valuedata: '0'
  SpynetReporting:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender\Spynet'
    valuename: 'SpynetReporting'
    valuetype: 'Dword'
    valuedata: '2'
  DisableAntiSpyware:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows Defender'
    valuename: 'DisableAntiSpyware'
    valuetype: 'Dword'
    valuedata: '0'
  MitigationOptions_FontBocking:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\MitigationOptions'
    valuename: 'MitigationOptions_FontBocking'
    valuetype: 'String'
    valuedata: '1000000000000'
  RestrictRemoteClients:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Rpc'
    valuename: 'RestrictRemoteClients'
    valuetype: 'Dword'
    valuedata: '1'
  MinEncryptionLevel:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Terminal Services'
    valuename: 'MinEncryptionLevel'
    valuetype: 'Dword'
    valuedata: '3'
  fDisableCdm:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Terminal Services'
    valuename: 'fDisableCdm'
    valuetype: 'Dword'
    valuedata: '1'
  DisablePasswordSaving:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Terminal Services'
    valuename: 'DisablePasswordSaving'
    valuetype: 'Dword'
    valuedata: '1'
  fPromptForPassword:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Terminal Services'
    valuename: 'fPromptForPassword'
    valuetype: 'Dword'
    valuedata: '1'
  fEncryptRPCTraffic:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows NT\Terminal Services'
    valuename: 'fEncryptRPCTraffic'
    valuetype: 'Dword'
    valuedata: '1'
  EnableFirewall:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\WindowsFirewall\DomainProfile'
    valuename: 'EnableFirewall'
    valuetype: 'Dword'
    valuedata: '1'
  DefaultOutboundAction:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\WindowsFirewall\DomainProfile'
    valuename: 'DefaultOutboundAction'
    valuetype: 'Dword'
    valuedata: '0'
  DefaultInboundAction:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\WindowsFirewall\DomainProfile'
    valuename: 'DefaultInboundAction'
    valuetype: 'Dword'
    valuedata: '1'
  DefaultOutboundAction1:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\WindowsFirewall\PrivateProfile'
    valuename: 'DefaultOutboundAction'
    valuetype: 'Dword'
    valuedata: '0'
  EnableFirewall1:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\WindowsFirewall\PrivateProfile'
    valuename: 'EnableFirewall'
    valuetype: 'Dword'
    valuedata: '1'
  DefaultInboundAction1:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\WindowsFirewall\PrivateProfile'
    valuename: 'DefaultInboundAction'
    valuetype: 'Dword'
    valuedata: '1'
  EnableFirewall2:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\WindowsFirewall\PublicProfile'
    valuename: 'EnableFirewall'
    valuetype: 'Dword'
    valuedata: '1'
  DefaultOutboundAction2:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\WindowsFirewall\PublicProfile'
    valuename: 'DefaultOutboundAction'
    valuetype: 'Dword'
    valuedata: '0'
  DefaultInboundAction2:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\WindowsFirewall\PublicProfile'
    valuename: 'DefaultInboundAction'
    valuetype: 'Dword'
    valuedata: '1'
  AdmPwdEnabled:
    key: 'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft Services\AdmPwd'
    valuename: 'AdmPwdEnabled'
    valuetype: 'Dword'
    valuedata: '1'

# CIS
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System: NoConnectedUser
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa: LimitBlankPasswordUse
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa: SCENoApplyLegacyAuditPolicy
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa: CrashOnAuditFail
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon: AllocateDASD
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print\Providers\LanMan Print Services\Servers: AddPrinterDrivers
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa:SubmitControl
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NTDS\Parameters:LDAPServerIntegrity
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters:RefusePasswordChange
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters:RequireSignOrSeal
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters:SealSecureChannel
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters:SignSecureChannel
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters:DisablePasswordChange
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters:RequireStrongKey
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System:DontDisplayLastUserName
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System:DisableCAD
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System:InactivityTimeoutSecs
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System:LegalNoticeText
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System:LegalNoticeCaption
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon:CachedLogonsCount
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon:PasswordExpiryWarning
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon:ForceUnlockLogon
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon:ScRemoveOption
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters:RequireSecuritySignature
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters:EnableSecuritySignature
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters:EnablePlainTextPassword
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters:AutoDisconnect
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters:RequireSecuritySignature
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters:EnableSecuritySignature
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters:EnableForcedLogoff
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters:SMBServerNameHardeningLevel
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa:RestrictAnonymousSAM
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa:RestrictAnonymous
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa:DisableDomainCreds
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa:EveryoneIncludesAnonymous
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters:NullSessionPipes
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedExactPaths:Machine
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurePipeServers\Winreg\AllowedPaths:Machine
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters:RestrictNullSessAccess
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa:restrictremotesam
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters:NullSessionShares
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa:ForceGuest
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa:UseMachineId
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0:AllowNullSessionFallback
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\pku2u:AllowOnlineID
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Kerberos\Parameters:SupportedEncryptionTypes
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa:NoLMHash
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanManServer\Parameters:EnableForcedLogOff
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa:LmCompatibilityLevel
